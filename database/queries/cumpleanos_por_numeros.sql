-- =============================================================================
-- Obtener cumpleaños de usuarios por lista de números (teléfonos)
-- Origen: números del Excel Reporte_Numeros_CON_UN_SOLO_NOMBRE_FINAL.xlsx
-- Tabla: usuario (Fe_Nacimiento, Nu_Celular, No_Nombres_Apellidos)
-- =============================================================================
-- Cómo usar:
-- 1. Exporta la columna de números del Excel a un archivo de texto (un número por línea)
--    o copia los números y reemplaza en la query (ver ejemplos abajo).
-- 2. Los números se comparan normalizados (sin espacios, guiones, paréntesis, +51).
-- =============================================================================

-- Opción A: Lista fija de números (reemplaza 987654321, 912345678 por tus números del Excel)
SELECT
    u.ID_Usuario,
    u.No_Nombres_Apellidos,
    u.Nu_Celular,
    u.Fe_Nacimiento,
    u.Txt_Email
FROM usuario u
WHERE 1 = 1
  AND u.Fe_Nacimiento IS NOT NULL
  AND (
    TRIM(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', ''), '51', '')) IN (
      '987654321',
      '912345678',
      '51944119988',
'51900244165',
'51980306086',
'51920278044',
'51997412500',
'51956306757',
'51936222770',
'51999902570',
'51946209598',
'51962131929',
'51986670681',
'51946049931',
'51981466498',
'51940136456',
'51935192298',
'51997480474',
'51999699816',
'51980787514',
'51982528373',
'51981519877',
'51978491578',
'51928252181',
'51994294553',
'51901332628',
'51990070051',
'51923725634',
'51956686057',
'51963485545',
'51980533058',
'51982097245',
'51949112065',
'51996206319',
'51988861514',
'51988317273',
'51957261755',
'51984874720',
'51996032051',
'51951880948',
'51967718738',
'51984790514',
'51953354629',
'51972263251',
'51933339209',
'51994954180',
'51956032494',
'51936673753',
'19047993311',
'51964913667',
'51942001497',
'51913737313',
'51992329733',
'51913260268',
'51931469986',
'51975877042',
'19254571573',
'51977151514',
'51917766456',
'51947497945',
'51954198550',
'51965830485',
'51922388008',
'51940758282',
'51986926639',
'51927938797',
'51998501998',
'51990060838',
'51915092388',
'51946661112',
'33658337191',
'51950686429',
'51965497474',
'51969200045',
'51904391075',
'51940469505',
'51942173529',
'51969254108',
'51947337240',
'51957880534',
'51930830992',
'51935375121',
'51945376637',
'51902176262',
'51980629142',
'51904526424',
'51960990952',
'51902843298',
'51944685591',
'51923338802',
'51997724710',
'51907213043',
'51933343119',
'51951263977',
'51941092365',
'51948745054',
'51998232507',
'51910415435',
'51965951491',
'51902393814',
'51997166376',
'51985858900',
'51945307716',
'51991462806',
'51942759574',
'51987902340',
'51936827272',
'51945187936',
'51959307220',
'51987620145',
'51916167281',
'51921081739',
'51933008245',
'51989793792',
'51934945136',
'51976852089',
'59164163152',
'51925423963',
'51964123689',
'51942399815',
'51956153217',
'51975011666',
'51931184043',
'51920413714',
'51949208727',
'51932151808',
'51934726489',
'51942348501',
'51961534379',
'51937411450',
'51992722252',
'51918928859',
'51935682446',
'51980571063',
'51936124059',
'51946050766',
'51953437404',
'81704375749',5
'51966421761',
'51936647406',
'51955126180',
'51924908998',
'51912263865',
'51925239251',
'51984658424',
'51958936113',
'51963317709',
'51948537604',
'51994740743',
'51987609492',
'51922569622',
'51948221045',
'51924340464',
'51952513518',
'51959396513',
'51989515589',
'51923238005',
'51935689784',
'51964160973',
'51997891484',
'51964745600',
'51977962030',
'51966670753',
'51987167542',
'51977125868',
'51968910579',
'51941764902',
'51956903506',
'51982849979',
'51912768538',
'51921284934',
'51948461779',
'51999009687',
'51948105071',
'51957299574',
'51978206804',
'51970466854',
'51998940040',
'51958761250',
'51950946911',
'51926785528',
'51983704868',
'51998889686',
'51925333428',
'51932046266',
'51929539406',
'51915955139',
'51947647375',
'51952687062',
'51954714458',
'51985223690',
'51984481013',
'51925759748',
'51945263455',
'51984988365',
'51964170764',
'51986536410',
'51933971726',
'51998924623',
'51981089603',
'51946065371',
'51977373558',
'51998316531',
'51998380465',
'51933095583',
'51997839006',
'51980660599',
'51990477927',
'51928759881',
'51974318400',
'51910448977',
'51971065517',
'51983511601',
'51977501066',
'51916132268',
'51946094419',
'51998622767',
'51990155066',
'51926878684',
'51965286039',
'51930818825',
'51964357536',
'51935197370',
'51933776716',
'51969186370',
'51907970298',
'51948015669',
'51999960226',
'51931924221',
'51997768877',
'51922182093',
'51936297184',
'51931918274',
'51981041287',
'51983696999',
'51929322723',
'51949990997',
'51940404707',
'51912396528',
'51986867594',
'51966205353',
'51945256608',
'51946335752',
'51919193832',
'51985054822',
'51956363676',
'51999062593',
'51926841477',
'51948823790',
'51934919577',
'51987131532',
'51948216399',
'51972809525',
'51956556167',
'51950766759',
'51991613372',
'51913437181',
'51997897044',
'51974429982',
'51919526805',
'51978726730',
'51963121435',
'51913577841',
'51982347359',
'51994013295',
'51957646003',
'51992727563',
'51972896791',
'51927803078',
'51989077415',
'51977706138',
'51910499065',
'51901320919',
'51953451061',
'51917036102',
'51956500637',
'51996496183',
'51933333873',
'51981472192',
'51989522237',
'51933482842',
'51997234849',
'51949699407',
'51965082273',
'51902183943',
'51987108915',
'51959739817',
'51935106826',
'51999342421',
'51983840593',
'51975091224',
'51990446795',
'51970387212',
'51961313105',
'51993475272',
'51994546374',
'51933372982',
'51929032026',
'51956230290',
'51965730408',
'51926494958',
'51902742300',
'51962253741',
'51954166473',
      -- Añade aquí más números, uno por línea, sin comas finales en el último
    )
    OR REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') IN (
      '51987654321',
      '51912345678',
      '51944119988',
'51900244165',
'51980306086',
'51920278044',
'51997412500',
'51956306757',
'51936222770',
'51999902570',
'51946209598',
'51962131929',
'51986670681',
'51946049931',
'51981466498',
'51940136456',
'51935192298',
'51997480474',
'51999699816',
'51980787514',
'51982528373',
'51981519877',
'51978491578',
'51928252181',
'51994294553',
'51901332628',
'51990070051',
'51923725634',
'51956686057',
'51963485545',
'51980533058',
'51982097245',
'51949112065',
'51996206319',
'51988861514',
'51988317273',
'51957261755',
'51984874720',
'51996032051',
'51951880948',
'51967718738',
'51984790514',
'51953354629',
'51972263251',
'51933339209',
'51994954180',
'51956032494',
'51936673753',
'19047993311',
'51964913667',
'51942001497',
'51913737313',
'51992329733',
'51913260268',
'51931469986',
'51975877042',
'19254571573',
'51977151514',
'51917766456',
'51947497945',
'51954198550',
'51965830485',
'51922388008',
'51940758282',
'51986926639',
'51927938797',
'51998501998',
'51990060838',
'51915092388',
'51946661112',
'33658337191',
'51950686429',
'51965497474',
'51969200045',
'51904391075',
'51940469505',
'51942173529',
'51969254108',
'51947337240',
'51957880534',
'51930830992',
'51935375121',
'51945376637',
'51902176262',
'51980629142',
'51904526424',
'51960990952',
'51902843298',
'51944685591',
'51923338802',
'51997724710',
'51907213043',
'51933343119',
'51951263977',
'51941092365',
'51948745054',
'51998232507',
'51910415435',
'51965951491',
'51902393814',
'51997166376',
'51985858900',
'51945307716',
'51991462806',
'51942759574',
'51987902340',
'51936827272',
'51945187936',
'51959307220',
'51987620145',
'51916167281',
'51921081739',
'51933008245',
'51989793792',
'51934945136',
'51976852089',
'59164163152',
'51925423963',
'51964123689',
'51942399815',
'51956153217',
'51975011666',
'51931184043',
'51920413714',
'51949208727',
'51932151808',
'51934726489',
'51942348501',
'51961534379',
'51937411450',
'51992722252',
'51918928859',
'51935682446',
'51980571063',
'51936124059',
'51946050766',
'51953437404',
'81704375749',5
'51966421761',
'51936647406',
'51955126180',
'51924908998',
'51912263865',
'51925239251',
'51984658424',
'51958936113',
'51963317709',
'51948537604',
'51994740743',
'51987609492',
'51922569622',
'51948221045',
'51924340464',
'51952513518',
'51959396513',
'51989515589',
'51923238005',
'51935689784',
'51964160973',
'51997891484',
'51964745600',
'51977962030',
'51966670753',
'51987167542',
'51977125868',
'51968910579',
'51941764902',
'51956903506',
'51982849979',
'51912768538',
'51921284934',
'51948461779',
'51999009687',
'51948105071',
'51957299574',
'51978206804',
'51970466854',
'51998940040',
'51958761250',
'51950946911',
'51926785528',
'51983704868',
'51998889686',
'51925333428',
'51932046266',
'51929539406',
'51915955139',
'51947647375',
'51952687062',
'51954714458',
'51985223690',
'51984481013',
'51925759748',
'51945263455',
'51984988365',
'51964170764',
'51986536410',
'51933971726',
'51998924623',
'51981089603',
'51946065371',
'51977373558',
'51998316531',
'51998380465',
'51933095583',
'51997839006',
'51980660599',
'51990477927',
'51928759881',
'51974318400',
'51910448977',
'51971065517',
'51983511601',
'51977501066',
'51916132268',
'51946094419',
'51998622767',
'51990155066',
'51926878684',
'51965286039',
'51930818825',
'51964357536',
'51935197370',
'51933776716',
'51969186370',
'51907970298',
'51948015669',
'51999960226',
'51931924221',
'51997768877',
'51922182093',
'51936297184',
'51931918274',
'51981041287',
'51983696999',
'51929322723',
'51949990997',
'51940404707',
'51912396528',
'51986867594',
'51966205353',
'51945256608',
'51946335752',
'51919193832',
'51985054822',
'51956363676',
'51999062593',
'51926841477',
'51948823790',
'51934919577',
'51987131532',
'51948216399',
'51972809525',
'51956556167',
'51950766759',
'51991613372',
'51913437181',
'51997897044',
'51974429982',
'51919526805',
'51978726730',
'51963121435',
'51913577841',
'51982347359',
'51994013295',
'51957646003',
'51992727563',
'51972896791',
'51927803078',
'51989077415',
'51977706138',
'51910499065',
'51901320919',
'51953451061',
'51917036102',
'51956500637',
'51996496183',
'51933333873',
'51981472192',
'51989522237',
'51933482842',
'51997234849',
'51949699407',
'51965082273',
'51902183943',
'51987108915',
'51959739817',
'51935106826',
'51999342421',
'51983840593',
'51975091224',
'51990446795',
'51970387212',
'51961313105',
'51993475272',
'51994546374',
'51933372982',
'51929032026',
'51956230290',
'51965730408',
'51926494958',
'51902742300',
'51962253741',
'51954166473',
    )
  )
ORDER BY u.No_Nombres_Apellidos;

-- =============================================================================
-- Opción B: Usar tabla temporal con los números del Excel (MySQL)
-- Ejecuta primero el INSERT con tus números, luego el SELECT.
-- =============================================================================

-- DROP TEMPORARY TABLE IF EXISTS tmp_numeros_cumpleanos;
-- CREATE TEMPORARY TABLE tmp_numeros_cumpleanos (numero VARCHAR(20));

-- INSERT INTO tmp_numeros_cumpleanos (numero) VALUES
-- ('987654321'),
-- ('912345678');
-- -- Pega aquí una fila por cada número del Excel

-- SELECT
--     u.ID_Usuario,
--     u.No_Nombres_Apellidos,
--     u.Nu_Celular,
--     u.Fe_Nacimiento,
--     u.Txt_Email
-- FROM usuario u
-- INNER JOIN tmp_numeros_cumpleanos t ON (
--     REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') = REPLACE(REPLACE(t.numero, ' ', ''), '51', '')
--     OR REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') = t.numero
--     OR REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') LIKE CONCAT('%', REPLACE(REPLACE(t.numero, ' ', ''), '51', ''), '%')
-- )
-- WHERE u.Fe_Nacimiento IS NOT NULL
-- ORDER BY u.No_Nombres_Apellidos;

-- =============================================================================
-- Opción C: LIKE por cada número (útil si los formatos varían mucho)
-- Reemplaza ONLY_NUMBER por el número a buscar (ej: 997351212)
-- =============================================================================

-- SELECT
--     u.ID_Usuario,
--     u.No_Nombres_Apellidos,
--     u.Nu_Celular,
--     u.Fe_Nacimiento
-- FROM usuario u
-- WHERE u.Fe_Nacimiento IS NOT NULL
--   AND (
--     REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') LIKE '%ONLY_NUMBER%'
--     OR REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(u.Nu_Celular, ' ', ''), '-', ''), '(', ''), ')', ''), '+', '') LIKE '%51ONLY_NUMBER%'
--   );


'51944119988',
'51900244165',
'51980306086',
'51920278044',
'51997412500',
'51956306757',
'51936222770',
'51999902570',
'51946209598',
'51962131929',
'51986670681',
'51946049931',
'51981466498',
'51940136456',
'51935192298',
'51997480474',
'51999699816',
'51980787514',
'51982528373',
'51981519877',
'51978491578',
'51928252181',
'51994294553',
'51901332628',
'51990070051',
'51923725634',
'51956686057',
'51963485545',
'51980533058',
'51982097245',
'51949112065',
'51996206319',
'51988861514',
'51988317273',
'51957261755',
'51984874720',
'51996032051',
'51951880948',
'51967718738',
'51984790514',
'51953354629',
'51972263251',
'51933339209',
'51994954180',
'51956032494',
'51936673753',
'19047993311',
'51964913667',
'51942001497',
'51913737313',
'51992329733',
'51913260268',
'51931469986',
'51975877042',
'19254571573',
'51977151514',
'51917766456',
'51947497945',
'51954198550',
'51965830485',
'51922388008',
'51940758282',
'51986926639',
'51927938797',
'51998501998',
'51990060838',
'51915092388',
'51946661112',
'33658337191',
'51950686429',
'51965497474',
'51969200045',
'51904391075',
'51940469505',
'51942173529',
'51969254108',
'51947337240',
'51957880534',
'51930830992',
'51935375121',
'51945376637',
'51902176262',
'51980629142',
'51904526424',
'51960990952',
'51902843298',
'51944685591',
'51923338802',
'51997724710',
'51907213043',
'51933343119',
'51951263977',
'51941092365',
'51948745054',
'51998232507',
'51910415435',
'51965951491',
'51902393814',
'51997166376',
'51985858900',
'51945307716',
'51991462806',
'51942759574',
'51987902340',
'51936827272',
'51945187936',
'51959307220',
'51987620145',
'51916167281',
'51921081739',
'51933008245',
'51989793792',
'51934945136',
'51976852089',
'59164163152',
'51925423963',
'51964123689',
'51942399815',
'51956153217',
'51975011666',
'51931184043',
'51920413714',
'51949208727',
'51932151808',
'51934726489',
'51942348501',
'51961534379',
'51937411450',
'51992722252',
'51918928859',
'51935682446',
'51980571063',
'51936124059',
'51946050766',
'51953437404',
'81704375749',5
'51966421761',
'51936647406',
'51955126180',
'51924908998',
'51912263865',
'51925239251',
'51984658424',
'51958936113',
'51963317709',
'51948537604',
'51994740743',
'51987609492',
'51922569622',
'51948221045',
'51924340464',
'51952513518',
'51959396513',
'51989515589',
'51923238005',
'51935689784',
'51964160973',
'51997891484',
'51964745600',
'51977962030',
'51966670753',
'51987167542',
'51977125868',
'51968910579',
'51941764902',
'51956903506',
'51982849979',
'51912768538',
'51921284934',
'51948461779',
'51999009687',
'51948105071',
'51957299574',
'51978206804',
'51970466854',
'51998940040',
'51958761250',
'51950946911',
'51926785528',
'51983704868',
'51998889686',
'51925333428',
'51932046266',
'51929539406',
'51915955139',
'51947647375',
'51952687062',
'51954714458',
'51985223690',
'51984481013',
'51925759748',
'51945263455',
'51984988365',
'51964170764',
'51986536410',
'51933971726',
'51998924623',
'51981089603',
'51946065371',
'51977373558',
'51998316531',
'51998380465',
'51933095583',
'51997839006',
'51980660599',
'51990477927',
'51928759881',
'51974318400',
'51910448977',
'51971065517',
'51983511601',
'51977501066',
'51916132268',
'51946094419',
'51998622767',
'51990155066',
'51926878684',
'51965286039',
'51930818825',
'51964357536',
'51935197370',
'51933776716',
'51969186370',
'51907970298',
'51948015669',
'51999960226',
'51931924221',
'51997768877',
'51922182093',
'51936297184',
'51931918274',
'51981041287',
'51983696999',
'51929322723',
'51949990997',
'51940404707',
'51912396528',
'51986867594',
'51966205353',
'51945256608',
'51946335752',
'51919193832',
'51985054822',
'51956363676',
'51999062593',
'51926841477',
'51948823790',
'51934919577',
'51987131532',
'51948216399',
'51972809525',
'51956556167',
'51950766759',
'51991613372',
'51913437181',
'51997897044',
'51974429982',
'51919526805',
'51978726730',
'51963121435',
'51913577841',
'51982347359',
'51994013295',
'51957646003',
'51992727563',
'51972896791',
'51927803078',
'51989077415',
'51977706138',
'51910499065',
'51901320919',
'51953451061',
'51917036102',
'51956500637',
'51996496183',
'51933333873',
'51981472192',
'51989522237',
'51933482842',
'51997234849',
'51949699407',
'51965082273',
'51902183943',
'51987108915',
'51959739817',
'51935106826',
'51999342421',
'51983840593',
'51975091224',
'51990446795',
'51970387212',
'51961313105',
'51993475272',
'51994546374',
'51933372982',
'51929032026',
'51956230290',
'51965730408',
'51926494958',
'51902742300',
'51962253741',
'51954166473',
